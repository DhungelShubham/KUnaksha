<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.124/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.124/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
  <style>
    #searchBar {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 100;
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }
    #searchInput {
      width: 200px;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    #searchResults {
      position: absolute;
      background: white;
      width: 200px;
      border: 1px solid #ccc;
      border-radius: 3px;
      display: none;
    }
    .resultItem {
      padding: 5px;
      cursor: pointer;
    }
    .resultItem:hover {
      background: #eee;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <div id="searchBar">
    <input type="text" id="searchInput" placeholder="Search location...">
    <div id="searchResults"></div>
  </div>

  <script type="module">
    // Create the viewer with OpenStreetMap as the base layer
    const viewer = new Cesium.Viewer("cesiumContainer", {
      animation: false,
      timeline: false,
      clock: false,
      baseLayerPicker: false,
      homeButton: false,
      sceneModePicker: false,
      navigationHelpButton: false,
      fullscreenButton: false,
      //geocoder: false,
      imageryProvider: new Cesium.OpenStreetMapImageryProvider({
        url: 'https://a.tile.openstreetmap.org/',
        credit: 'Â© OpenStreetMap contributors'
      }),
      terrainProvider: new Cesium.EllipsoidTerrainProvider() // Flat terrain
    });

    // Enable lighting effects based on sun position
    viewer.scene.globe.enableLighting = true;

    // Configure map settings for better appearance
    viewer.scene.globe.baseColor = Cesium.Color.WHITE;
    viewer.scene.globe.showGroundAtmosphere = true;
    viewer.scene.fog.enabled = true;
    
    // Example locations data
    const locations = [
      {
        name: "Eiffel Tower",
        lat: 48.8584,
        lon: 2.2945,
        alt: 300,
        description: "A wrought-iron lattice tower on the Champ de Mars in Paris, France.",
        image: "https://via.placeholder.com/300x200"
      },
      {
        name: "Statue of Liberty",
        lat: 40.6892,
        lon: -74.0445,
        alt: 100,
        description: "A colossal neoclassical sculpture on Liberty Island in New York Harbor.",
        image: "https://via.placeholder.com/300x200"
      }
    ];

    // Add locations to the viewer
    locations.forEach(location => {
      const position = Cesium.Cartesian3.fromDegrees(location.lon, location.lat, location.alt);
      viewer.entities.add({
        name: location.name, 
        position: position,
        point: {
          pixelSize: 15,
          color: Cesium.Color.YELLOW,
          outlineColor: Cesium.Color.BLACK,
          outlineWidth: 2,
        },
        description: `
          <h3>${location.name}</h3>
          <p><b>Description:</b> ${location.description}</p>
          <p><b>Latitude:</b> ${location.lat.toFixed(6)}</p>
          <p><b>Longitude:</b> ${location.lon.toFixed(6)}</p>
          <p><b>Altitude:</b> ${location.alt.toFixed(6)} meters</p>
          <img src="${location.image}" width="300px" style="border-radius: 10px;">
        `,
      });
    });

    // Fly to the entities
    viewer.flyTo(viewer.entities);

    // Search functionality
    const searchInput = document.getElementById("searchInput");
    const searchResults = document.getElementById("searchResults");
    
    searchInput.addEventListener("input", () => {
      const query = searchInput.value.toLowerCase();
      searchResults.innerHTML = "";
      if (!query) {
        searchResults.style.display = "none";
        return;
      }
      
      const filtered = locations.filter(loc => loc.name.toLowerCase().includes(query));
      filtered.forEach(loc => {
        const div = document.createElement("div");
        div.className = "resultItem";
        div.textContent = loc.name;
        div.onclick = () => flyToLocation(loc);
        searchResults.appendChild(div);
      });
      searchResults.style.display = filtered.length ? "block" : "none";
    });
    
    function flyToLocation(location) {
      viewer.flyTo(viewer.entities.values.find(entity => entity.name === location.name));
      searchResults.style.display = "none";
      searchInput.value = "";
    }
  </script>
</body>
</html>